server:
  # 8080 - ??????????? ???? ??? "??????? ?????"
  port: 8080

spring:
  application:
    # ?????, ??? ???? ??? ?????? ?????????????? ? Eureka
    name: api-gateway

  cloud:
    gateway:
      discovery:
        locator:
          # ?????? ??????????? ????????? ????????? ?? ?????? ???? ???????? ? Eureka
          enabled: true
          lower-case-service-id: true # ?????????? ????? ???????? ? ?????? ??????? (????? ????????)

      # ???? ?? ???? ??????? ?? ???????, ?? ?????? ?????? ???????? ??????
      # ?? ??????????? ?? ????? ?? ???? 2, ??? ????????? ?????????
      routes:
        # ?????????? ID ????????
        - id: user_service_route
          # ???????: 'lb://' ??????? "load balanced" (? ????????????? ????????????)
          # ?? ???? Gateway: "??????? ? Eureka, ?? ??????????? 'user-service'"
          uri: lb://USER-SERVICE
          predicates:
            # ???? ????? ????????? ?? /api/v1/users/ (??? /auth/...)
            - Path=/api/v1/users/**, /api/v1/auth/**

        - id: product_service_route
          uri: lb://PRODUCT-SERVICE
          predicates:
            # ???? ????? ????????? ?? /api/v1/products/...
            - Path=/api/v1/products/**

# ???????? ?????? Gateway (???? ? Eureka-????????), ?? ??????????? Eureka-??????
eureka:
  client:
    service-url:
      # ?????????? ?????? ?????? Service Discovery
      defaultZone: http://localhost:8761/eureka/
    # ?? ????KEV, ??? Gateway ???????????? ? ????????? ?????? ????????
    register-with-eureka: true
    fetch-registry: true